{% extends 'postbox/base.html' %}

{% block title %}Events of {{ user.username }}{% endblock %}

{% block content %}
<style>
  body.dark-mode .event-card { 
    background-color: #1e293b; 
    color: #f1f5f9; 
    border-top-color: #374151; 
}
body.dark-mode .event-date,
body.dark-mode .event-description,
body.dark-mode .event-badges .badge {
    color: #e2e8f0;
}
body.dark-mode .event-footer { 
    background-color: #334155; 
    border-top-color: #475569;
}
body.dark-mode .event-footer a.btn { 
    background: linear-gradient(to right, #2563eb, #1e3a8a); 
    color: #f1f5f9;
}
body.dark-mode .event-footer a.btn:hover { 
    background: linear-gradient(to right, #1e40af, #1d4ed8); 
    color: #fff;
}
body.dark-mode .event-creator { 
    color: #cbd5e1; 
}

/* ===== Container ===== */
.events-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1.5rem;
    padding: 2rem;
}

/* ===== Event Card ===== */
.event-card {
    background-color: #ffffff;
    border-radius: 16px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    display: flex;
    flex-direction: column;
    justify-content: flex-start; 
    transition: transform 0.2s, box-shadow 0.2s;
}

.event-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.12);
}

.event-card.has-image, .event-card.no-image {
    height: auto; 
}

/* ===== Event Types ===== */
.event-card[data-type="birthday"] { border-top: 5px solid #443154; } 
.event-card[data-type="graduation"] { border-top: 5px solid #232025; }
.event-card[data-type="anniversary"] { border-top: 5px solid #101223; }
.event-card[data-type="other"] { border-top: 5px solid #6b759f; }

/* ===== Event Content ===== */
.event-content {
    padding: 1rem 1rem 0.5rem 1rem;
}
.event-type-icon { font-size: 1rem; margin-bottom: 0.3rem; display: inline-block; cursor: default; animation: pulse 2s infinite; }
@keyframes pulse { 0% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.05); opacity: 0.8; } 100% { transform: scale(1); opacity: 1; } }
.event-title { font-size: 1.25rem; font-weight: 600; margin-bottom: 0.3rem; }
.event-date { font-size: 0.85rem; color: #6b7280; }
.event-description { font-size: 0.95rem; color: #374151; }

/* ===== Event Image ===== */
.event-image-wrapper img {
    width: 100%;
    border-radius: 0 0 16px 16px;
    object-fit: cover;
    max-height: 200px;
    display: block;
}

/* ===== Event Footer ===== */
.event-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 1rem;
    border-top: 1px solid #e5e7eb;
    background-color: #f9fafb;
    border-radius: 0 0 16px 16px;
}
.event-badges .badge { margin-right: 0.5rem; font-size: 0.85rem; }
.event-footer a.btn {
    font-size: 0.8rem;
    background: linear-gradient(to right, #1e40af, #2563eb);
    color: #fff;
    border-radius: 8px;
    padding: 0.35rem 0.75rem;
    transition: background 0.3s;
}
.event-footer a.btn:hover { background: linear-gradient(to right, #2563eb, #1e3a8a); color: #fff; }

/* ===== Event Creator ===== */
.event-creator { text-align: right; font-size: 0.75rem; color: #6b7280; padding: 0.25rem 1rem; }
.creator-link { text-decoration: none; color: #2563eb; }
.creator-link:hover { text-decoration: underline; }

/* ===== No Events ===== */
.no-events { text-align: center; font-size: 1rem; color: #6b7280; padding: 2rem; }

/* ===== Responsive (Media Queries) ===== */
@media (max-width: 1024px) {
    .events-container { grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); padding: 1.5rem; }
}

@media (max-width: 768px) {
    .events-container { grid-template-columns: 1fr; padding: 1rem; }
    .event-footer { flex-direction: column; gap: 0.5rem; align-items: flex-start; }
    .event-footer a.btn { width: 100%; text-align: center; }
}
</style>


<h1 class="text-center my-4">Events of {{ user.username }}</h1>

{% if events %}
<div class="events-container">
    {% for event in events %}
    <div class="event-card {% if event.image %}has-image{% else %}no-image{% endif %}" data-type="{{ event.event_type }}">
        
        <div class="event-content">
            <div class="event-type-icon 
                {% if event.event_type == 'other' %}other
                {% elif event.event_type == 'wedding' %}anniversary
                {% elif event.event_type == 'birthday' %}birthday
                {% elif event.event_type == 'graduation' %}graduation
                {% endif %}">
                {% if event.event_type == 'other' %}‚ú® Other
                {% elif event.event_type == 'anniversary' %}üíç Anniversary
                {% elif event.event_type == 'birthday' %}üéÇ Birthday
                {% elif event.event_type == 'graduation' %}üéì Graduation
                {% endif %}
            </div>

            <h5 class="event-title">{{ event.title }}</h5>
            <p class="event-date">{{ event.event_date|date:"M. d, Y" }}</p>
            <p class="event-description">{{ event.description|truncatewords:20 }}</p>
        </div>

        {% if event.image %}
        <div class="event-image-wrapper">
            <img src="{{ event.image.url }}" alt="{{ event.title }}">
        </div>
        {% endif %}

        <div class="event-footer">
    <div class="event-badges">
        <span class="badge bg-primary">{{ event.hearts }} ‚ù§Ô∏è</span>
        <span class="badge bg-success">{{ event.thumbs }} üëç</span>
        <span class="badge bg-warning">{{ event.tada }} üéâ</span>
        <span class="badge bg-comment">üí¨ {{ event.comments.count }}</span>
    </div>
    <a href="{% url 'postbox:event_detail' event.id %}" class="btn">View</a>
</div>

          

        <div class="event-creator">
            Created by: 
            <a href="{% url 'postbox:user_events' event.user.username %}" class="creator-link">
                {{ event.user.username }}
            </a>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="no-events">
    No events found for this user.
</div>
{% endif %}
{% endblock %}
